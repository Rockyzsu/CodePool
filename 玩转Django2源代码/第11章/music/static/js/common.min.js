define(["jquery"],function(b){function v(a,d,b){var c=a.width(),e=a.height(),f=d.width(),g=d.height(),m="auto",n="auto";f>=g?b?n=e:m=c:b?m=c:n=e;a.css({position:"relative"});d.css({position:"absolute",width:m+"px",height:n+"px"});a=(e-d.height())/2;c=(c-d.width())/2;d.css({top:a+"px",left:c+"px"})}function k(){b(".layz_load").each(function(a,d){var f=b(d).find("img");if(w(d))f.attr("src",f.attr("data-src")).hide().on("load",function(){var a=f.parent();f.fadeIn().parent().removeClass("layz_load");
a.hasClass("pic_po")&&v(a,f,!0)})})}function w(a){a=a.getBoundingClientRect();return(0<a.top||0<a.top+a.height)&&a.top<=(window.innerHeight||document.documentElement.clientHeight)}function l(a,d,b,c,e,h){this.w=a;this.f=d;this.a=b;this.now=0;this.t=c;this.timer=null;this.lb=e;this.rb=h}function x(a,d){var b=Math.floor(Math.random()*a);return b==d?x(a,d):b}function r(a,d){function f(a){a.fadeOut(200,function(){a.remove()})}var c={time:0,title:"\u6e29\u99a8\u63d0\u793a",content:"",maskClose:!1,button:1},
e="",h=b('<div class="box_mask"></div>'),g=b('<div class="box_wrap"></div>');a&&"object"==typeof a?b.each(a,function(a,b){c[a]=b}):c.content=a;e+='<div class="box_title">'+c.title+'</div><div class="box_content"><div class="box_in">'+c.content+'</div></div><div class="box_btn_wrap">';1==c.button?e+='<button class="confirm_btn">\u786e\u5b9a</button>':2==c.button&&(e+='<button class="confirm_btn">\u786e\u5b9a</button><button class="cancel_btn">\u53d6\u6d88</button>');g.html(e+'</div><div class="box_close"></div>');
b("body").append([h,g]);a=g.width();e=g.height();h.css("zIndex",p);p++;g.css({marginTop:-(e/2)+"px",marginLeft:-(a/2)+"px",zIndex:p});h.hide().fadeIn();g.hide().fadeIn();if(c.maskClose)h.on("click",function(){f(h);f(g)});g.on("click",".box_close,button",function(){f(h);f(g);b(this).hasClass("confirm_btn")&&d&&d()});"number"==typeof c.time&&0<c.time&&setTimeout(function(){f(h);f(g)},c.time)}b(".rank-list").on("mouseenter","li",function(){b(this).addClass("current").siblings().removeClass("current")});
b("#toHead").on("click",function(){b("html").animate({scrollTop:0},"swing")});var t=b("html").scrollTop();500<=t?b("#toHead").fadeIn():b("#toHead").fadeOut();var u=null,q=null;k();b(window).on("scroll",function(){q||(q=setTimeout(function(){clearTimeout(q);q=null;t=b("html").scrollTop();500<=t?b("#toHead").fadeIn():b("#toHead").fadeOut();u&&clearTimeout(u);u=setTimeout(k,100)},500))});l.prototype.init=function(){var a=this,d=this.w.find(".f_s"),f=d.length,d=d.eq(0).width()*f;this.w.css({position:"relative",
zIndex:0,overflow:"hidden"}).find(".f_w").css({position:"absolute",left:"0",width:d+"px",transition:".5s"}).on({mouseenter:function(){a.a&&clearInterval(a.timer)},mouseleave:function(){a.a&&a.autoPlay()}});null!=this.f&&(this.f.find(".f_c").length>f&&b.each(this.f.find(".f_c"),function(a,d){a>=f&&b(d).remove()}),this.f.css({position:"relative",zIindex:1}).on({mouseenter:function(){a.a&&clearInterval(a.timer)},mouseleave:function(){a.a&&a.autoPlay()}}).on("click",".f_c",function(){a.now=b(this).index();
a.move()}));if(null!=this.lb)this.lb.on({mouseenter:function(){a.a&&clearInterval(a.timer)},mouseleave:function(){a.a&&a.autoPlay()},click:function(){a.now--;0>a.now&&(a.now=f-1);a.move()}});if(null!=this.rb)this.rb.on({mouseenter:function(){a.a&&clearInterval(a.timer)},mouseleave:function(){a.a&&a.autoPlay()},click:function(){a.now++;a.now>=f&&(a.now=0);a.move()}});this.a&&this.autoPlay()};l.prototype.move=function(){var a=this.w.find(".f_s").eq(0).width();this.w.find(".f_w").css({left:-this.now*
a+"px"});null!=this.f&&this.f.find(".f_c").eq(this.now).addClass("active").siblings().removeClass("active")};l.prototype.autoPlay=function(){var a=this,b=this.w.find(".f_s");this.timer=setInterval(function(){a.now>=b.length-1?a.now=0:a.now++;a.move()},this.t||5E3)};var p=9999;return{setPicPo:v,showImg:k,pages:function(a,b,f){var c="",e=1,d;if(!b||1>=b)f.empty();else{1!=a&&(c+='<a href="javascript:;" class="prev" data-page="'+(a-1)+'"><i></i>\u4e0a\u4e00\u9875</a>');if(6<b){c=1==a?c+'<span class="sel">1</span>':
c+'<a href="javascript:;" data-page="1">1</a>';e=2<a-2?a-2:2;d=+a+2<b-1?+a+2:b-1;for(2<e&&(c+="<span>...</span>");e<=d;e++)c=e==a?c+('<span class="sel">'+e+"</span>"):c+('<a href="javascript:;" data-page="'+e+'">'+e+"</a>");1<b-d&&(c+="<span>...</span>");c=a==b?c+('<span class="sel">'+b+"</span>"):c+('<a href="javascript:;" data-page="'+b+'">'+b+"</a>")}else for(;e<=b;e++)c=e==a?c+('<span class="sel">'+e+"</span>"):c+('<a href="javascript:;" data-page="'+e+'">'+e+"</a>");a<b&&(c+='<a href="javascript:;" class="next" data-page="'+
(+a+1)+'"><i></i>\u4e0b\u4e00\u9875</a>');f.html(c)}},checkPosition:w,addPk:function(a,d,f,c){var e=b("#v3CompareItems").find("li"),h=e.length,g,m,n,k,l=!0;b.each(e,function(c,d){b(d).find("input").val()==a&&(l=!1)});l?(2<=h?(r("\u6700\u591a\u53ea\u80fdPK2\u9996\u6b4c\u66f2"),l=!1):(e=b("<li>"),g=b('<span class="v3-compare-item-del">\u5173\u95ed</span>'),c=b('<a class="pic" target="play" title="'+d+"-"+c+'" href="/song_'+a+'.html"></a>'),m=b('<img alt="'+d+'\u7684\u5c01\u9762">'),d=b("<span>"+d+"</span>"),
n=b('<input type="hidden">'),n.val(a),m.attr("src",f),e.append(g).append(c.append(m).append(d)).append(n),b("#v3CompareItems").append(e),b("#v3CompareNum").text(h+1)),e=b("#v3CompareItems").find("li"),2==e.length&&(k="/pk",b.each(e,function(a,c){a=b(c).find("input").val();isNaN(a/1)&&(a=a.slice(a.indexOf("_")+1,a.indexOf(".")));k+="_"+a}),k+=".html",b("#v3CompareParamBtn").attr({href:k,target:"_blank"}))):r("\u6b4c\u66f2\u5df2\u7ecf\u5b58\u5728");b("#v3CompareBox").show();return l},tabSwitch:function(a,
d,f){a.on("click",".t_c",function(){b(this).addClass("current").siblings().removeClass("current");d.find(".t_s").eq(b(this).index()).addClass("current").siblings().removeClass("current").hide().end().show(0,function(){k()});"function"==typeof f&&f()})},FocusSwitch:l,getRandom:x,loadOpen:function(){b("#maskLoad").fadeIn(200)},loadClose:function(){b("#maskLoad").fadeOut(200)},pkTicket:function(a,b,f,c,e){f=parseInt(f);c=parseInt(c);var d=c/(f+c)*e;a.css("height",f/(f+c)*e+"px");b.css("height",d+"px")},
msg:function(a,d){var f={time:3E3},c=b('<div class="box_msg"><div class="con"></div></div>');c.find(".con").text(a);b("body").append(c);a=c.width();var e=c.height();c.css({marginTop:-(e/2)+"px",marginLeft:-(a/2)+"px",zIndex:++p});c.hide().fadeIn();d&&"object"==typeof d&&b.each(d,function(a,b){f[a]=b});setTimeout(function(){c.fadeOut(200,function(){b(this).remove()})},f.time)},alert:r}});
